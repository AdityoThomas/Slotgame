<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Slot Boongan</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <style>
    body {
      background: radial-gradient(#0f0f1a, #000);
      color: #00ffcc;
      font-family: 'Orbitron', sans-serif;
      text-align: center;
      padding: 30px;
    }
    h1, h2 {
      color: #00f0ff;
      text-shadow: 0 0 10px #00f0ff;
    }
    .slot-container {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 30px 0;
    }
    .slot-col {
      position: relative;
      width: 80px;
      height: 80px;
      overflow: hidden;
      border: 3px solid #0088cc;
      border-radius: 12px;
      background: #111;
      box-shadow: 0 0 10px #00eaff88;
    }
    .symbol-list {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      transition: transform 0.5s ease-out;
    }
    .symbol {
      height: 80px;
      font-size: 48px;
      line-height: 80px;
    }
    .btn {
      padding: 14px 28px;
      font-size: 18px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px;
      font-family: 'Orbitron', sans-serif;
      transition: 0.3s;
    }
    #spin { background: #00cc66; color: #000; box-shadow: 0 0 10px #00cc66aa; }
    #screenshot { background: #ff6600; color: #fff; box-shadow: 0 0 10px #ff6600aa; }
    .btn:hover { transform: scale(1.05); }
    #score { margin-top: 20px; font-size: 24px; }
    ol { text-align: left; max-width: 300px; margin: 0 auto; padding: 0; }
    li { margin: 5px 0; }
  </style>
</head>
<body>

  <h1>üé∞ Selamat Datang di Game Slot Boongan üé∞</h1>

  <div class="slot-container">
    <div class="slot-col" id="col1"><div class="symbol-list"></div></div>
    <div class="slot-col" id="col2"><div class="symbol-list"></div></div>
    <div class="slot-col" id="col3"><div class="symbol-list"></div></div>
  </div>

  <button class="btn" id="spin">SPIN</button>
  <button class="btn" id="screenshot">üì∏ Screenshot</button>
  <div id="score">Skor: 0</div>

  <h2>üèÜ Leaderboard</h2>
  <ol id="leaderboard"></ol>

  <script>
    const firebaseConfig = {
      apiKey: "ISIKAN_API_KEY_KAMU",
      authDomain: "ISIKAN_AUTH_DOMAIN",
      projectId: "ISIKAN_PROJECT_ID",
      storageBucket: "ISIKAN_BUCKET",
      messagingSenderId: "ISIKAN_SENDER_ID",
      appId: "ISIKAN_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const symbols = [
      { symbol: "üçí", chance: 30, points: 10 },
      { symbol: "üîî", chance: 20, points: 50 },
      { symbol: "üí£", chance: 20, points: 0 },
      { symbol: "üíé", chance: 5,  points: 5000000 },
      { symbol: "7Ô∏è‚É£", chance: 25, points: 100 }
    ];

    let totalScore = 0;

    function getRandomSymbol() {
      const total = symbols.reduce((a, b) => a + b.chance, 0);
      let rand = Math.random() * total;
      for (let s of symbols) {
        if (rand < s.chance) return s;
        rand -= s.chance;
      }
    }

    async function spinColumn(colId, finalSymbol) {
      const col = document.getElementById(colId).querySelector('.symbol-list');
      col.style.transition = "none";
      col.style.transform = "translateY(0px)";
      col.innerHTML = "";
      await new Promise(r => setTimeout(r, 10));

      const spinSymbols = [];
      for (let i = 0; i < 10; i++) {
        const s = symbols[Math.floor(Math.random() * symbols.length)].symbol;
        spinSymbols.push(s);
      }
      spinSymbols.push(finalSymbol.symbol);

      for (let sym of spinSymbols) {
        const el = document.createElement("div");
        el.className = "symbol";
        el.textContent = sym;
        col.appendChild(el);
      }

      await new Promise(r => setTimeout(r, 10));
      col.style.transition = "transform 0.5s ease-out";
      col.style.transform = `translateY(-${80 * (spinSymbols.length - 1)}px)`;

      await new Promise(r => setTimeout(r, 600));
    }

    async function spinAll() {
      document.getElementById("spin").disabled = true;

      const results = [getRandomSymbol(), getRandomSymbol(), getRandomSymbol()];
      await Promise.all([
        spinColumn("col1", results[0]),
        new Promise(r => setTimeout(() => spinColumn("col2", results[1]).then(r), 150)),
        new Promise(r => setTimeout(() => spinColumn("col3", results[2]).then(r), 300))
      ]);

      const syms = results.map(s => s.symbol);
      let score = 0;
      if (syms.every(s => s === "üíé")) {
        score = 5000000;
        alert("üíé JACKPOT 5 JUTA!");
      } else if (syms.includes("üí£")) {
        score = 0;
        alert("üí£ ZONK!");
      } else if (syms.filter(s => s === "üçí").length === 2) {
        score = 250;
        alert("üçíüçí BONUS 250!");
      } else {
        score = results.reduce((sum, s) => sum + s.points, 0);
      }

      totalScore += score;
      document.getElementById("score").textContent = `Skor: ${totalScore}`;

      const username = prompt("Masukkan namamu:", "Player");
      if (username) {
        db.collection("leaderboard").doc(username).set({
          name: username,
          score: totalScore
        });
      }

      document.getElementById("spin").disabled = false;
    }

    document.getElementById("spin").addEventListener("click", spinAll);
    document.getElementById("screenshot").addEventListener("click", () => {
      html2canvas(document.body).then(canvas => {
        const link = document.createElement("a");
        link.download = "slot-boongan.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
      });
    });

    const lb = document.getElementById("leaderboard");
    db.collection("leaderboard").orderBy("score", "desc").limit(10)
      .onSnapshot(snapshot => {
        lb.innerHTML = "";
        snapshot.forEach(doc => {
          const d = doc.data();
          const li = document.createElement("li");
          li.textContent = `${d.name}: ${d.score}`;
          lb.appendChild(li);
        });
      });
  </script>

</body>
  </html>
